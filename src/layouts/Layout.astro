---
import "@fontsource/instrument-serif";
import "@fontsource-variable/instrument-sans";
import "../assets/scss/globals.scss";
import { VisualEditing } from "@sanity/astro/visual-editing";

// Check environment variable (eerste prioriteit)
const envVisualEditingEnabled =
  import.meta.env.PUBLIC_SANITY_VISUAL_EDITING_ENABLED == "true";

// Check URL parameter als fallback (voor productie)
// Gebruik Astro.request.url voor query parameters in SSR mode
const requestUrl = new URL(Astro.request.url);
console.log("Layout Debug - request.url:", Astro.request.url);
console.log("Layout Debug - requestUrl.toString():", requestUrl.toString());
const urlPreviewEnabled = requestUrl.searchParams.get("preview") === "true";

// Visual editing enabled wanneer:
// - Environment variable is true, OF
// - URL parameter preview=true is aanwezig
const visualEditingEnabled = envVisualEditingEnabled || urlPreviewEnabled;

// Debug logging (verwijder dit later)
console.log("Visual Editing Debug:", {
  envVisualEditingEnabled,
  urlPreviewEnabled,
  visualEditingEnabled,
  url: requestUrl.toString(),
  searchParams: Object.fromEntries(requestUrl.searchParams),
});
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>Astro Basics</title>
  </head>
  <div class="u-container">
    <div class="u-grid">
      <slot />
      <VisualEditing enabled={visualEditingEnabled} />
    </div>
  </div>


</html>
